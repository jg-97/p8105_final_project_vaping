<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="logistic_reg_siquan">logistic_reg_Siquan</h1>
<p>Siquan 12/2/2019</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Loading the cleaned data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">load</span>(<span class="st">&quot;./data/nyc_data.RData&quot;</span>)</a></code></pre></div>
<p>#I decide to use LASSO to automatically help me choose the important covariates in the logistic regression model based on cross-validation error</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Extracting necessary variables (in the following analysis, we only focus on the variables extracted by Daniela in the original'Logistics Regressin.Rmd')</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">df =<span class="st"> </span>df_total <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2017</span><span class="op">|</span><span class="st"> </span>year <span class="op">==</span><span class="dv">2015</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Basing model on data from both 2015 and 2017</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    year,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="co"># binary respone</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">    current_vaping,</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">    <span class="co"># possible predictor</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">    texting_and_driving,</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    carring_weapon,</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    sad_hopeless,</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">    attempted_suicide,</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">    injurious_suicide_attempt,</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">    safety_concerns_at_school,</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    threatened_at_school,</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">    physical_fighting,</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">    bullying_at_school,</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">    bullying_electronically,</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">    sex,</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">    age,</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">    race7,</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    borough)</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="kw">summary</span>(df)</a></code></pre></div>
<pre><code>##       year      current_vaping       texting_and_driving carring_weapon
##  Min.   :2015   Yes : 2997     Yes             :  935    Yes : 1441    
##  1st Qu.:2015   No  :14707     No/did not drive: 3114    No  :16482    
##  Median :2017   NA's: 1009     NA's            :14664    NA's:  790    
##  Mean   :2016                                                          
##  3rd Qu.:2017                                                          
##  Max.   :2017                                                          
##                                                                        
##  sad_hopeless attempted_suicide              injurious_suicide_attempt
##  Yes : 5547   Yes : 1496        Yes                       :  516      
##  No  :12316   No  :13678        No/did not attempt suicide:14343      
##  NA's:  850   NA's: 3539        NA's                      : 3854      
##                                                                       
##                                                                       
##                                                                       
##                                                                       
##  safety_concerns_at_school threatened_at_school physical_fighting
##  Yes : 1384                Yes : 1239           Yes : 4268       
##  No  :16824                No  :17128           No  :14030       
##  NA's:  505                NA's:  346           NA's:  415       
##                                                                  
##                                                                  
##                                                                  
##                                                                  
##  bullying_at_school bullying_electronically     sex      
##  Yes : 2716         Yes : 2341              female:9496  
##  No  :15490         No  :15921              male  :9032  
##  NA's:  507         NA's:  451              NA's  : 185  
##                                                          
##                                                          
##                                                          
##                                                          
##                     age                                 race7     
##  15 years old         :4776   Hispanic/Latino              :7990  
##  16 years old         :4360   Black or African American    :4184  
##  17 years old         :4092   White                        :2289  
##  14 years old         :3852   Asian                        :2159  
##  18 years old or older: 971   Multiple Races (Non-Hispanic): 582  
##  (Other)              : 573   (Other)                      : 506  
##  NA's                 :  89   NA's                         :1003  
##           borough    
##  Bronx        :3952  
##  Brooklyn     :5227  
##  Manhattan    :3857  
##  Queens       :3147  
##  Staten Island:2530  
##                      
## 
</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">str</span>(df)</a></code></pre></div>
<pre><code>## Classes 'tbl_df', 'tbl' and 'data.frame':    18713 obs. of  16 variables:
##  $ year                     : num  2015 2015 2015 2015 2015 ...
##  $ current_vaping           : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: NA 2 2 NA 2 2 2 2 2 1 ...
##  $ texting_and_driving      : Factor w/ 2 levels &quot;Yes&quot;,&quot;No/did not drive&quot;: NA NA NA NA 2 NA NA 2 NA 1 ...
##  $ carring_weapon           : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: NA NA 2 2 1 2 2 2 2 NA ...
##  $ sad_hopeless             : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: NA 1 2 2 NA 2 1 1 1 NA ...
##  $ attempted_suicide        : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: NA 1 2 2 NA 2 NA 2 2 1 ...
##  $ injurious_suicide_attempt: Factor w/ 2 levels &quot;Yes&quot;,&quot;No/did not attempt suicide&quot;: NA 2 2 2 NA 2 NA 2 2 2 ...
##  $ safety_concerns_at_school: Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: 1 1 2 2 1 2 2 2 2 1 ...
##  $ threatened_at_school     : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: NA NA 2 2 1 2 2 2 2 1 ...
##  $ physical_fighting        : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: NA NA 2 2 1 2 1 1 2 1 ...
##  $ bullying_at_school       : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: 2 2 2 1 1 2 2 1 2 1 ...
##  $ bullying_electronically  : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: 2 2 2 2 NA 2 1 2 2 NA ...
##  $ sex                      : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: NA NA NA NA NA NA NA NA NA NA ...
##  $ age                      : Factor w/ 7 levels &quot;12 years old or younger&quot;,..: NA NA NA NA 1 3 3 3 4 5 ...
##  $ race7                    : Factor w/ 7 levels &quot;American Indian/Alaska Native&quot;,..: 4 NA NA 4 NA 3 7 NA 3 NA ...
##  $ borough                  : Factor w/ 5 levels &quot;Bronx&quot;,&quot;Brooklyn&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#Remove all observations with any missing value</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">df&lt;-<span class="kw">na.omit</span>(df)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#Split data into training and test data set</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">sample_size =<span class="st"> </span><span class="kw">floor</span>(<span class="fl">0.8</span><span class="op">*</span><span class="kw">nrow</span>(df))</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">8105</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">picked =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(df)),<span class="dt">size =</span> sample_size)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">data_tr =df[picked,]</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">data_te =df[<span class="op">-</span>picked,]</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">x_tr &lt;-<span class="st"> </span>data_tr[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">16</span>)]</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">y_tr &lt;-<span class="st"> </span>data_tr[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">x_te &lt;-<span class="st"> </span>data_te[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">16</span>)]</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">y_te &lt;-<span class="st"> </span>data_te[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#use LASSO since we have so many predictors and automatically let R help us select the important variables</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="kw">colnames</span>(data_tr)</a></code></pre></div>
<pre><code>##  [1] &quot;year&quot;                      &quot;current_vaping&quot;           
##  [3] &quot;texting_and_driving&quot;       &quot;carring_weapon&quot;           
##  [5] &quot;sad_hopeless&quot;              &quot;attempted_suicide&quot;        
##  [7] &quot;injurious_suicide_attempt&quot; &quot;safety_concerns_at_school&quot;
##  [9] &quot;threatened_at_school&quot;      &quot;physical_fighting&quot;        
## [11] &quot;bullying_at_school&quot;        &quot;bullying_electronically&quot;  
## [13] &quot;sex&quot;                       &quot;age&quot;                      
## [15] &quot;race7&quot;                     &quot;borough&quot;
</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(glmnet)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">library</span>(gmodels)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#create train set input</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">Training_x &lt;-<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>carring_weapon <span class="op">+</span>texting_and_driving <span class="op">+</span>carring_weapon<span class="op">+</span>sad_hopeless<span class="op">+</span>attempted_suicide<span class="op">+</span>injurious_suicide_attempt<span class="op">+</span><span class="st"> </span>safety_concerns_at_school<span class="op">+</span>threatened_at_school<span class="op">+</span>physical_fighting<span class="op">+</span>bullying_at_school<span class="op">+</span>bullying_electronically<span class="op">+</span>sex<span class="op">+</span>age<span class="op">+</span>race7<span class="op">+</span>borough <span class="dv">-1</span>, data_tr)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#Use LASSO to do auto variable selection accoridng to cross-validation error</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">cv.lasso &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(Training_x, <span class="kw">as.matrix</span>(<span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_tr))<span class="op">-</span><span class="dv">1</span>), <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">model_lasso &lt;-<span class="st"> </span><span class="kw">glmnet</span>(Training_x, <span class="kw">as.matrix</span>(<span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_tr))<span class="op">-</span><span class="dv">1</span>), <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,<span class="dt">lambda =</span> cv.lasso<span class="op">$</span>lambda.min)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="kw">coef</span>(model_lasso)</a></code></pre></div>
<pre><code>## 30 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                                                s0
## (Intercept)                                         -1.625174e+02
## year                                                 7.982888e-02
## carring_weaponYes                                   -5.041743e-01
## carring_weaponNo                                     9.114951e-15
## texting_and_drivingNo/did not drive                  7.694352e-01
## sad_hopelessNo                                       2.967696e-01
## attempted_suicideNo                                  6.810848e-01
## injurious_suicide_attemptNo/did not attempt suicide  .           
## safety_concerns_at_schoolNo                          3.235722e-01
## threatened_at_schoolNo                               7.252697e-02
## physical_fightingNo                                  8.646754e-01
## bullying_at_schoolNo                                 .           
## bullying_electronicallyNo                            3.467696e-01
## sexmale                                              .           
## age13 years old                                      .           
## age14 years old                                      4.971420e-01
## age15 years old                                      .           
## age16 years old                                      .           
## age17 years old                                      .           
## age18 years old or older                             9.396247e-02
## race7Asian                                           .           
## race7Black or African American                       7.866188e-01
## race7Hispanic/Latino                                 .           
## race7Multiple Races (Non-Hispanic)                   .           
## race7Native Hawaiian/Other Pacific Islander          .           
## race7White                                          -6.065113e-01
## boroughBrooklyn                                     -7.535410e-03
## boroughManhattan                                     7.095502e-02
## boroughQueens                                        .           
## boroughStaten Island                                 .
</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#Training set prediction accuracy</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">model_lasso_train&lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">predict</span>(model_lasso, Training_x, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>))</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">CrossTable</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_tr))<span class="op">-</span><span class="dv">1</span>,<span class="dt">y =</span> model_lasso_train, <span class="dt">prop.r =</span> F, <span class="dt">prop.c =</span> F, <span class="dt">prop.chisq =</span> F)</a></code></pre></div>
<pre><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  1787 
## 
##  
##                              | model_lasso_train 
## as.numeric(unlist(y_tr)) - 1 |         0 |         1 | Row Total | 
## -----------------------------|-----------|-----------|-----------|
##                            0 |       135 |       329 |       464 | 
##                              |     0.076 |     0.184 |           | 
## -----------------------------|-----------|-----------|-----------|
##                            1 |        47 |      1276 |      1323 | 
##                              |     0.026 |     0.714 |           | 
## -----------------------------|-----------|-----------|-----------|
##                 Column Total |       182 |      1605 |      1787 | 
## -----------------------------|-----------|-----------|-----------|
## 
## 
</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_tr))<span class="op">-</span><span class="dv">1</span> <span class="op">==</span>model_lasso_train)</a></code></pre></div>
<pre><code>## [1] 0.7895915
</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co">#Test set prediction accuracy</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">Testing_x &lt;-<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>carring_weapon <span class="op">+</span>texting_and_driving <span class="op">+</span>carring_weapon<span class="op">+</span>sad_hopeless<span class="op">+</span>attempted_suicide<span class="op">+</span>injurious_suicide_attempt<span class="op">+</span><span class="st"> </span>safety_concerns_at_school<span class="op">+</span>threatened_at_school<span class="op">+</span>physical_fighting<span class="op">+</span>bullying_at_school<span class="op">+</span>bullying_electronically<span class="op">+</span>sex<span class="op">+</span>age<span class="op">+</span>race7<span class="op">+</span>borough <span class="dv">-1</span>, data_te)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">model_lasso_test&lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">predict</span>(model_lasso, Testing_x, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>))</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="kw">CrossTable</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_te))<span class="op">-</span><span class="dv">1</span>,<span class="dt">y =</span> model_lasso_test, <span class="dt">prop.r =</span> F, <span class="dt">prop.c =</span> F, <span class="dt">prop.chisq =</span> F)</a></code></pre></div>
<pre><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  447 
## 
##  
##                              | model_lasso_test 
## as.numeric(unlist(y_te)) - 1 |         0 |         1 | Row Total | 
## -----------------------------|-----------|-----------|-----------|
##                            0 |        29 |        77 |       106 | 
##                              |     0.065 |     0.172 |           | 
## -----------------------------|-----------|-----------|-----------|
##                            1 |        22 |       319 |       341 | 
##                              |     0.049 |     0.714 |           | 
## -----------------------------|-----------|-----------|-----------|
##                 Column Total |        51 |       396 |       447 | 
## -----------------------------|-----------|-----------|-----------|
## 
## 
</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_te))<span class="op">-</span><span class="dv">1</span> <span class="op">==</span>model_lasso_test)</a></code></pre></div>
<pre><code>## [1] 0.7785235
</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">#Use prediction accuracy as the evaluation matrix in binary classification task, train set prediction accuracy  0.7879127 and test set prediction accuracy 0.7785235. Since the training set and test set accuracy are pretty close, there is no overfitting.</span></a></code></pre></div>
<p>#Note that we could do the same procedure with the imputed data and see whether the prediction accuracy has been imporved.</p>
<p>#Also note that we could add more potential covariates into the model and see whether the prediction accuracy has been imporved.</p>
<p>#Compare with the original model</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">fit_logistic =<span class="st"> </span><span class="kw">glm</span>(current_vaping <span class="op">~</span><span class="st"> </span>sad_hopeless <span class="op">+</span><span class="st"> </span>attempted_suicide  <span class="op">+</span><span class="st"> </span>safety_concerns_at_school <span class="op">+</span><span class="st"> </span>threatened_at_school <span class="op">+</span><span class="st"> </span>physical_fighting <span class="op">+</span><span class="st"> </span>bullying_electronically <span class="op">+</span><span class="st"> </span>carring_weapon, <span class="dt">data =</span> data_tr, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">fit_logistics_predict =<span class="st"> </span><span class="kw">round</span>(<span class="kw">predict</span>(fit_logistic, data_te, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>))</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="kw">CrossTable</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_te))<span class="op">-</span><span class="dv">1</span>,<span class="dt">y =</span> fit_logistics_predict, <span class="dt">prop.r =</span> F, <span class="dt">prop.c =</span> F, <span class="dt">prop.chisq =</span> F)</a></code></pre></div>
<pre><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  447 
## 
##  
##                              | fit_logistics_predict 
## as.numeric(unlist(y_te)) - 1 |         0 |         1 | Row Total | 
## -----------------------------|-----------|-----------|-----------|
##                            0 |        20 |        86 |       106 | 
##                              |     0.045 |     0.192 |           | 
## -----------------------------|-----------|-----------|-----------|
##                            1 |        17 |       324 |       341 | 
##                              |     0.038 |     0.725 |           | 
## -----------------------------|-----------|-----------|-----------|
##                 Column Total |        37 |       410 |       447 | 
## -----------------------------|-----------|-----------|-----------|
## 
## 
</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y_te))<span class="op">-</span><span class="dv">1</span> <span class="op">==</span>fit_logistics_predict)</a></code></pre></div>
<pre><code>## [1] 0.7695749
</code></pre>
<p>The original model has a test prediction accuracy of 0.7695749, which is a little bit lower than the LASSO model, but I think both of these two models are okay and we could then try to model with imputede data and even adding some more covariates we are interested in to the model.</p>

</body>
</html>
